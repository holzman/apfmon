{% extends "mon/base.html" %}
{% load url from future %}
{% load timesince_human %}

{% block content %}

{% if status %}
<div class="alert alert-info">
  <strong>Note:</strong> {{ status }}
</div>
{% endif %}

<h2>ATLAS pilot factory monitor</h2>

<div class="row">
  <div class="span6">
    <form class="well form-search" action="{% url 'apfmon.mon.views.search' %}" method="GET" name="search">
      <input type="text" class="input-large search-query" placeholder="Site or queue name" name="q" value="{{ query|escape }}">
      <button type="submit" class="btn">Search</button>
    </form>
  </div>
</div>


<div class="row-fluid">
<div class=span6>
<table class="table table-compact table-striped"> 
<tr>
<th title="factory name">Factory
<th class=num title="Number of queues configured">queues
<th class=num title="age of last modification">last activity
<th class=num title="factory version">version
</tr>
{% for row in rows %}
<tr>
  <td><a href="{% url 'apfmon.mon.views.factory' row.factory.id %}">{{ row.factory }}</a>
  <td class=num>{{ row.nqueue }}
  <td class="num {{ row.active }}">{{ row.factory.last_modified|timesince_human }}
  {% if row.factory.version %}
    <td class=num>{{ row.factory.version }}
  {% else %}
    <td class=num>-
  {% endif %}
</tr>
{% empty %}
<tr>
  <td colspan=4 class=note>No factories found.
{% endfor %}

</table>

</div>
</div>

{% endblock %}
