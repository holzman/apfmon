{% extends "mon/base.html" %}

{% block content %}

<h2>Factory view: {{ factory.name }}</h2>

{% comment %}
{% endcomment %}

<p>
<table class="left noborder">
<tr><td>FACTORY</td><td>{{ factory.name }}</td></tr>
<tr><td>VERSION</td><td> {{ factory.version }}</td></tr>
<tr><td>LAST STARTUP</td><td> {{ factory.last_startup|timesince }} ago</td></tr>
<tr><td>LAST CYCLE</td><td> {{ factory.last_modified|timesince }} ago</td></tr>
<tr><td>EMAIL</td><td> {{ factory.email }}</td></tr>
<tr><td>IP</td><td> {{ factory.ip }}</td></tr>
<tr><td>LOGS</td><td><a href={{ factory.url }}>{{ factory.url }}</a></td></tr>
</table>
</p>

<p>
{% ifequal plot "on" %}
  <img src="/media/states-1d-{{ factory.id }}-0.png" />
{% endifequal %}
</p>

<p>
<table>
<tr nowrap>
<th>Factory queue label
<th>created
<th>running
<th>exiting
<th>done (1 hr)
<th>fault (1 hr)
<th>last msg
</tr>
{% for row in rows %}
<tr class="{% cycle odd,even %}">
  <td nowrap class=left><a href="{% url atl.mon.views.pandaq row.label.pandaq.id %}">{{ row.label }}</a>
  <td class={{ row.statcr }}><a href="{% url atl.mon.views.jobs row.label.id 'CREATED' %}">{{ row.ncreated }}</a>
  <td><a href="{% url atl.mon.views.jobs row.label.id 'RUNNING' %}">{{ row.nrunning }}</a>
  <td><a href="{% url atl.mon.views.jobs row.label.id 'EXITING' %}">{{ row.nexiting }}</a>
  <td class={{ row.statdone }}><a href="{% url atl.mon.views.jobs row.label.id 'DONE' %}">{{ row.ndone }}</a>
  <td class={{ row.statfault }}><a href="{% url atl.mon.views.jobs row.label.id 'FAULT' %}">{{ row.nfault }}</a>
  <td class={{ row.activity }}><span title="{{ row.label.msg }}">{{ row.label.last_modified|timesince }} ago</span>
</tr>
<tr class=collapse>
  <td></td>
  <td colspan=6 class=right>{{ row.label.msg }}</td> 
</tr>
{% endfor %}
</table>
</p>
{% endblock %}
